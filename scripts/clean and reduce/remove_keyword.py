import json
import psycopg2

###keyword to remove

#removal 1 list
keywordList = [
'AIR POLLUTANTS',
'PARTICULATE MATTER',
'REGISTRIES',
'ANTI-BACTERIAL AGENTS',
'ULTRAVIOLET RAYS',
'CARDIOVASCULAR DISEASES',
'RHINITIS, ALLERGIC, SEASONAL',
'SUNLIGHT',
'VITAMIN D DEFICIENCY',
'ALLERGENS',
'POLLEN',
'WOUNDS AND INJURIES',
'GENOTYPE',
'LENGTH OF STAY',
'BODY MASS INDEX',
'STROKE',
'SKIN NEOPLASMS',
'CYCLONIC STORMS',
'ATHLETIC INJURIES',
'WORKPLACE',
'OBESITY',
'NEOPLASMS',
'DEPRESSION',
'OUT-OF-HOSPITAL CARDIAC ARREST',
'HEAT STRESS DISORDERS',
'DIET',
'SUICIDE',
'REAL-TIME POLYMERASE CHAIN REACTION',
'POSTOPERATIVE COMPLICATIONS',
'ACCIDENTS, TRAFFIC',
'MELANOMA',
'SMOKING',
'HYPERTENSION',
'MYOCARDIAL INFARCTION',
'SPECIES SPECIFICITY',
'GASTROENTERITIS',
'STRESS, PSYCHOLOGICAL',
'CIRCADIAN RHYTHM',
'BLOOD PRESSURE',
'HEART FAILURE',
'OCCUPATIONAL DISEASES',
'PATIENT ACCEPTANCE OF HEALTH CARE',
'PARTICLE SIZE',
'HYDROGEN-ION CONCENTRATION',
'CHRONIC DISEASE',
'INJURY SEVERITY SCORE',
'ATTITUDE OF HEALTH PERSONNEL',
'SEPSIS',
'MENTAL HEALTH',
'PLANT DISEASES',
'BACTERIAL PROTEINS',
'AMINO ACID SEQUENCE',
'POINT-OF-CARE SYSTEMS',
'MENTAL DISORDERS',
'HEALTH PROMOTION',
'PULMONARY DISEASE, CHRONIC OBSTRUCTIVE',
'CYTOKINES',
'EXERCISE',
'OUTCOME ASSESSMENT, HEALTH CARE',
'HEALTH BEHAVIOR',
'CARDIOPULMONARY RESUSCITATION',
'SULFUR DIOXIDE',
'AIR POLLUTION, INDOOR',
'DELIVERY OF HEALTH CARE',
'TERTIARY CARE CENTERS',
'PRACTICE GUIDELINES AS TOPIC',
'PHENOTYPE',
'HYPERSENSITIVITY',
'PREGNANCY COMPLICATIONS, INFECTIOUS',
'FOOTBALL',
'DIABETES MELLITUS',
'SOCCER',
'PRACTICE PATTERNS, PHYSICIANS',
'REFERRAL AND CONSULTATION',
'CELL LINE',
'POLYMORPHISM, SINGLE NUCLEOTIDE',
'STRESS DISORDERS, POST-TRAUMATIC',
'WATER POLLUTANTS, CHEMICAL',
'MOLECULAR DYNAMICS SIMULATION',
'KINETICS',
'DIABETES MELLITUS, TYPE 2',
'ALCOHOL DRINKING',
'HEART ARREST',
'DIETARY SUPPLEMENTS',
'ASIAN CONTINENTAL ANCESTRY GROUP',
'DRUG UTILIZATION',
'WORKFORCE',
'MILK',
'RHINITIS, ALLERGIC, PERENNIAL',
'WORKLOAD',
'SAFETY',
'ALLERGIC RHINITIS',
'ORGANIZATIONAL CULTURE',
'BLUETONGUE',
'MODELS, MOLECULAR',
'IMMUNOGLOBULIN G',
'RECOMBINANT PROTEINS',
'HEART RATE',
'BASE SEQUENCE',
'NUCLEIC ACID AMPLIFICATION TECHNIQUES',
'FOOD CONTAMINATION',
'C-REACTIVE PROTEIN',
'HOSPITALS, PEDIATRIC',
'STRESS, PHYSIOLOGICAL',
'AMBULATORY CARE',
'TRAUMA SEVERITY INDICES',
'GESTATIONAL AGE',
'PREGNANCY OUTCOME',
'EMERGENCY DEPARTMENT',
'PREMATURE BIRTH',
'ATRIAL FIBRILLATION',
'PROTEIN CONFORMATION',
'PARENTS',
'GENE EXPRESSION PROFILING',
'HISTORY, 20TH CENTURY',
'MULTIPLE SCLEROSIS',
'SLEEP',
'SAFETY MANAGEMENT',
'GENES, BACTERIAL',
'POACEAE',
'CARBON MONOXIDE',
'ATHLETES',
'MOLECULAR DOCKING SIMULATION',
'PSYCHODIDAE',
'PEDIATRICS',
'OCCUPATIONAL INJURIES',
'HYPOXIA',
'INPATIENTS',
'CARDIAC ARREST',
'MICROBIAL VIABILITY',
'BLOOD GLUCOSE',
'SUBSTANCE-RELATED DISORDERS',
'TRAUMA CENTERS',
'ACCIDENTAL FALLS',
'ELECTROCARDIOGRAPHY',
'PATIENT SATISFACTION',
'SIGNAL TRANSDUCTION',
'INFANT, PREMATURE',
'PATIENT SAFETY',
'FOOD HANDLING',
'GLASGOW COMA SCALE',
'MICE, INBRED BALB C',
'BODY TEMPERATURE REGULATION',
'SUNSCREENING AGENTS',
'MATERNAL EXPOSURE',
'ACUTE KIDNEY INJURY',
'INSULIN RESISTANCE',
'BODY WEIGHT',
'INJURY',
'TANDEM MASS SPECTROMETRY',
'POLYCYCLIC AROMATIC HYDROCARBONS',
'ECZEMA',
'MEDICAL RECORDS',
'OXIDATIVE STRESS',
'BINDING SITES',
'BRONCHIOLITIS',
'TRANSPORTATION',
'SEARCH ENGINE',
'SEAWATER',
'NUTRITION SURVEYS',
'ALLERGY',
'CELL LINE, TUMOR',
'TOMOGRAPHY, X-RAY COMPUTED',
'NASOPHARYNX',
'RESPIRATION, ARTIFICIAL',
'RHINITIS',
'VIOLENCE',
'BREAST NEOPLASMS',
'FOOD HYPERSENSITIVITY',
'PLANT LEAVES',
'GENE EXPRESSION',
'METABOLIC SYNDROME',
'MICROBIOTA',
'SPORTS',
'EMPLOYMENT',
'CARDIOVASCULAR DISEASE',
'SUNBURN',
'CHROMATOGRAPHY, HIGH PRESSURE LIQUID',
'ANTINEOPLASTIC AGENTS',
'RENAL DIALYSIS',
'AUTOMOBILE DRIVING',
'ASCOMYCOTA',
'VEHICLE EMISSIONS',
'ADAPTATION, PSYCHOLOGICAL',
'DERMATITIS, ATOPIC',
'PLANT EXTRACTS',
'BURNS',
'LUNG NEOPLASMS',
'ALTITUDE SICKNESS',
'NANOPARTICLES',
'DRUG PRESCRIPTIONS',
'HIV',
'CATHETER ABLATION',
'PROTEIN STABILITY',
'CELL SURVIVAL',
'FIRES',
'PRENATAL EXPOSURE DELAYED EFFECTS',
'JOB SATISFACTION',
'ANTIGENS, PLANT',
'FASCIOLIASIS',
'RENAL INSUFFICIENCY, CHRONIC',
'FREEZING',
'LEUKOCYTE COUNT',
'ACUTE CORONARY SYNDROME',
'CLONING, MOLECULAR',
'MYCOSES',
'KIDNEY FAILURE, CHRONIC',
'MOTOR VEHICLES',
'INFRARED RAYS',
'CROSS REACTIONS',
'CALICIVIRIDAE INFECTIONS',
'MICE, INBRED C57BL',
'LACTATION',
'MOTOR ACTIVITY',
'ARTEMISININS',
'REFERENCE VALUES',
'ABSENTEEISM',
'NEOPLASMS, RADIATION-INDUCED',
'CONJUNCTIVITIS, ALLERGIC',
'SOIL MICROBIOLOGY',
'DIABETES MELLITUS, TYPE 1',
'SMOKE',
'GENERAL PRACTICE',
'FASCIOLA HEPATICA',
'EPITOPES',
'INJURY PREVENTION',
'COMMERCE',
'CARCINOMA, SQUAMOUS CELL',
'GENOMICS',
'ADRENAL CORTEX HORMONES',
'HYDROCORTISONE',
'MAGNETIC RESONANCE IMAGING',
'HEAT STROKE',
'CRANIOCEREBRAL TRAUMA',
'PARTURITION',
'PM(2.5)',
'ENVIRONMENTAL POLLUTANTS',
'INTERLEUKIN-6',
'HOLIDAYS',
'MEDICARE',
'SCHIZOPHRENIA',
'HOSPITALS, TEACHING',
'BRAIN CONCUSSION',
'CORONARY ARTERY DISEASE',
'ACCIDENTS',
'CHROMATOGRAPHY, LIQUID',
'TRAUMA',
'NITRIC OXIDE',
'FRACTURES, BONE',
'ENVIRONMENTAL POLLUTION',
'APOPTOSIS',
'COMA',
'SKIING',
'THERMODYNAMICS',
'HEMODYNAMICS',
'BRAIN ISCHEMIA',
'MOTIVATION',
'ACCIDENTS, OCCUPATIONAL',
'ANTIOXIDANTS',
'ANAPHYLAXIS',
'COLORECTAL NEOPLASMS',
'WALKING',
'ADVERSE DRUG REACTION REPORTING SYSTEMS',
'BRAIN INJURIES',
'SEIZURES',
'INSURANCE, HEALTH',
'CONCUSSION',
'EXTRACORPOREAL MEMBRANE OXYGENATION',
'OTITIS MEDIA',
]

#removal 2 list
keywordList = [
'CANCER',
'MOTIVATION',
'DIET RECORDS',
'DROWNING',
'PM2.5',
'SURGICAL WOUND INFECTION',
'SUNBATHING',
'MONITORING, PHYSIOLOGIC',
'NEOPLASM STAGING',
'COLORECTAL NEOPLASMS',
'DRUG ADMINISTRATION SCHEDULE',
'DIABETES',
'SICK LEAVE',
'HIV-1',
'ULTRAVIOLET RADIATION',
'WALKING',
'PROTECTIVE CLOTHING',
'SUICIDE, ATTEMPTED',
'GERIATRIC ASSESSMENT',
'DEFIBRILLATORS, IMPLANTABLE',
'BRAIN INJURIES',
'CORONARY ANGIOGRAPHY',
'BIPOLAR DISORDER',
'OCCUPATIONAL STRESS',
'PHYSICAL EXERTION',
'EARTHQUAKES',
'SPORES, FUNGAL',
'TOBACCO SMOKE POLLUTION',
'INTENTION',
'ADIPOSITY',
'PHYSICAL ACTIVITY',
'LIGHT',
'BLOOD TRANSFUSION',
'SEEDS',
'ATTITUDE',
'KIDNEY TRANSPLANTATION',
'SEROTYPING',
'DRUG DESIGN',
'BICYCLING',
'HEAD PROTECTIVE DEVICES',
'ANTI-HIV AGENTS',
'HYDROGEN PEROXIDE',
'EPILEPSY',
'PLANTS, GENETICALLY MODIFIED',
'GENE EXPRESSION REGULATION, PLANT',
'CHEMOPREVENTION',
'SEDENTARY BEHAVIOR',
'SLEEP WAKE DISORDERS',
'PROSTATIC NEOPLASMS',
'CONSTRUCTION INDUSTRY',
'PSYCHIATRIC STATUS RATING SCALES',
'PSYCHOMETRICS',
'CYSTIC FIBROSIS',
'AMBULANCES',
'DEPRESSIVE DISORDER, MAJOR',
'DRUG STORAGE',
'DRUG CARRIERS',
'BURNOUT, PROFESSIONAL',
'MEDICAID',
'HEART DEFECTS, CONGENITAL',
'APPENDICITIS',
'WORK SCHEDULE TOLERANCE',
'DELIVERY, OBSTETRIC',
'CARDIAC SURGICAL PROCEDURES',
'RECREATION',
'INTERNSHIP AND RESIDENCY',
'HYDROGEN BONDING',
'OFFICE VISITS',
'OWNERSHIP',
'SPRAINS AND STRAINS',
'MULTIPLE TRAUMA',
'INSURANCE, HEALTH',
'DEMENTIA',
'LIVER CIRRHOSIS',
'PRETERM BIRTH',
'KNEE INJURIES',
'SUICIDAL IDEATION',
'DRUG MONITORING',
'REOPERATION',
'PAIN MEASUREMENT',
'CLINICAL COMPETENCE',
'DEPRESSIVE DISORDER',
'CARDIOPULMONARY BYPASS',
'EMOTIONS',
'METALS, HEAVY',
'LIGHTING',
'AIR QUALITY',
'SNAKE BITES',
'FINE PARTICULATE MATTER',
'GUILLAIN-BARRE SYNDROME',
'TABLETS',
'MICE, KNOCKOUT',
'ILLICIT DRUGS',
'ACUTE-ON-CHRONIC LIVER FAILURE',
'DNA FINGERPRINTING',
'SEASONAL AFFECTIVE DISORDER',
'CAPACITY BUILDING',
'PERSONNEL STAFFING AND SCHEDULING',
'INAPPROPRIATE PRESCRIBING',
'INJURIES',
'HIP FRACTURES',
'LIVER NEOPLASMS',
'CESAREAN SECTION',
'CIVIL DEFENSE',
'CONCUSSION',
'ALCOHOLIC INTOXICATION',
'TOBACCO',
'PEDIATRIC OBESITY',
'HAEMOSPORIDA',
'DRUG EVALUATION, PRECLINICAL',
'STRESS',
'OTITIS MEDIA',
'LIVER TRANSPLANTATION',
'EARLY DETECTION OF CANCER',
'TRANSCRIPTION FACTORS',
'STUDENTS, MEDICAL',
'PERCUTANEOUS CORONARY INTERVENTION',
'HISTORY, 19TH CENTURY',
'INFUSIONS, INTRAVENOUS',
'CHRONIC OBSTRUCTIVE PULMONARY DISEASE',
'CARBON MONOXIDE POISONING',
'MOTORCYCLES',
'INJURY SEVERITY',
'RUNNING',
'COAL',
'ELECTIVE SURGICAL PROCEDURES',
'BRAIN INJURIES, TRAUMATIC',
'WORK',
'TRAVEL MEDICINE',
'MILITARY MEDICINE',
'CUMULATIVE TRAUMA DISORDERS',
'GERIATRICS',
'DRUG OVERDOSE',
'ANXIETY DISORDERS',
'POLLUTION',
'FIREFIGHTERS',
'SOOT',
'SOCIAL ISOLATION',
'DISABLED PERSONS',
'MOUNTAINEERING',
'CATARACT',
'PRECISION MEDICINE',
'ARTHRITIS, RHEUMATOID',
'MEDICINE, CHINESE TRADITIONAL',
'HOMICIDE',
'CONSUMER PRODUCT SAFETY',
'ST ELEVATION MYOCARDIAL INFARCTION',
'UNEMPLOYMENT',
'DRUG RESISTANCE, NEOPLASM',
'INFANT, SMALL FOR GESTATIONAL AGE',
'BASEBALL',
'ERGONOMICS',
]

with open('local_config.json') as json_file:
	config = json.load(json_file)

#connect to do database and check if paper is already added.  If not add to todo list
conn = psycopg2.connect(host=config['endpoint'],database=config['database'], user=config['username'], password=config['password'])

cur = conn.cursor()

for keyword in keywordList:
	print(keyword)
	sqlPapers = f"""select paper.paper_id from paper
		inner join keyword_paper on paper.paper_id = keyword_paper.paper_id
		inner join keyword on keyword.keyword_id = keyword_paper.keyword_id
		where upper(keyword.keytext) = '{keyword}' and paper.removal_candidate = 0"""

	cur.execute(sqlPapers)
	sqlPapersRows = cur.fetchall()
	print(len(sqlPapersRows))


	for row in sqlPapersRows:
		sqlRemovePaperKeyword = f"""update paper set removal_candidate=3 where paper_id = {row[0]}"""
		cur.execute(sqlRemovePaperKeyword)
		conn.commit()